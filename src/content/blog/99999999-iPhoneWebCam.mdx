---
publish: true
title: "iPhoneのブラウザ上でのWebカメラの挙動を調べてみた"
publishDate: 2023-12-31
description: "iPhoneのブラウザ上で取得できるカメラ映像の画角などを調べた話。"
---

import Img from "../../components/Img.astro";

## あ

Webカメラ照準器なるものを作った。ほとんど実用性のないツールであるが、できる範囲で正確にしてみようと試みた。その際、iPhoneなどのスマホのブラウザ上で取得できるWebカメラ映像の画角を正確に知る必要があった。

## Webカメラをいじれるようにする

おそらくセキュリティの都合上、Webカメラはlocalhostかhttpsでしか使用できない。つまり、iPhone上でテストしたければ、いったんサイトにデプロイするか、ローカルでhttpsできるようにしないといけない。めんどいので、パラメータをJSON形式で自由に入力できる[Webカメラテストページ](/misc/webCameraTest)を作った。

## 画角を調べる

何も指定しないで表示させてみると、4:3の映像が現れた。これはOS標準アプリで静止画を撮影した際の縦横比と同じであり、おそらくイメージセンサの縦横比でもある。では、静止画と同じ範囲写っているのかというと、そうではなく、若干小さい範囲が映し出されている。ちなみに、iPhone SE (第3世代)の通常の静止画撮影時の画角は、Exifには28mm(35mm判換算だろう)と記載されている。

Webカメラの出力は動画なので、静止画と違うことは十分想定できた現象である。たとえばα7 IVでも、4K60pの動画を撮影する際にはAPS-Cサイズにクロップされる。では、動画撮影時と同じ画角なのかといえば、そうでもなく、それよりはだいぶ広い範囲が映っているようである。ちなみに、動画撮影時の画角は、撮影中に静止画ボタンを押して撮影した画像のExifによれば、34mmである。

よくわからないので要求する縦横比を変更してみる。順当に16:9(1.7777...)を指定してみるとどうだろうか。結果は、短辺方向は4:3と同じ範囲、長辺方向はより広い範囲が映った。つまり、縦方向に縮むのではなく、横方向に伸びた。2:1などさらに細長くしてみると、こんどは縦方向に縮んだ。どうやら、他の縦横比の映像は、16:9の映像から切り出されているようである。

ここで奇妙なことに気づく。通常の静止画では映っていなかった範囲が、Webカメラの16:9の映像には含まれているのである。長辺は広く、短辺は狭くなっている。正確に比較してみると、対角線の画角が同じになるように、つまり、35mm判換算の焦点距離で画角を表現すれば同じ値になるようになっているようである。

## センサが余ってる?

一部でも4:3の写真よりも広い範囲を取得できるということは、イメージセンサは4:3であるのに、写真を撮影する際にそれを使いきっていないということになる。それは無駄なのではないか、と言いたくなる。おそらく、イメージサークルはセンサ全体をカバーしていないと考えられる。

低フレームレートでもいいので録画に使えたら面白いのにな、とは思う。

なお、SONYのXperiaでは1型センサを盛大に余らせている。